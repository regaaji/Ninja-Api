function cov_1nnps9vlb2(){var path="/home/programmer/git/Ninja-Api/src/controllers/books.js";var hash="9ff4c56aaec1e433f4a11a747d56c35943f06128";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/programmer/git/Ninja-Api/src/controllers/books.js",statementMap:{"0":{start:{line:1,column:13},end:{line:1,column:39}},"1":{start:{line:3,column:20},end:{line:3,column:55}},"2":{start:{line:4,column:15},end:{line:4,column:42}},"3":{start:{line:6,column:0},end:{line:236,column:1}},"4":{start:{line:8,column:6},end:{line:34,column:7}},"5":{start:{line:9,column:22},end:{line:9,column:48}},"6":{start:{line:10,column:27},end:{line:10,column:50}},"7":{start:{line:11,column:28},end:{line:11,column:54}},"8":{start:{line:12,column:23},end:{line:12,column:51}},"9":{start:{line:14,column:27},end:{line:16,column:9}},"10":{start:{line:18,column:26},end:{line:18,column:59}},"11":{start:{line:20,column:27},end:{line:20,column:55}},"12":{start:{line:22,column:27},end:{line:28,column:9}},"13":{start:{line:29,column:23},end:{line:29,column:70}},"14":{start:{line:30,column:8},end:{line:30,column:58}},"15":{start:{line:32,column:8},end:{line:32,column:26}},"16":{start:{line:33,column:8},end:{line:33,column:70}},"17":{start:{line:38,column:6},end:{line:47,column:7}},"18":{start:{line:40,column:21},end:{line:40,column:38}},"19":{start:{line:41,column:25},end:{line:41,column:55}},"20":{start:{line:42,column:10},end:{line:42,column:48}},"21":{start:{line:45,column:8},end:{line:45,column:26}},"22":{start:{line:46,column:8},end:{line:46,column:78}},"23":{start:{line:51,column:4},end:{line:88,column:5}},"24":{start:{line:55,column:8},end:{line:65,column:11}},"25":{start:{line:56,column:14},end:{line:59,column:15}},"26":{start:{line:63,column:14},end:{line:63,column:33}},"27":{start:{line:77,column:23},end:{line:77,column:50}},"28":{start:{line:78,column:8},end:{line:78,column:33}},"29":{start:{line:79,column:8},end:{line:79,column:44}},"30":{start:{line:86,column:6},end:{line:86,column:24}},"31":{start:{line:87,column:6},end:{line:87,column:53}},"32":{start:{line:92,column:4},end:{line:126,column:5}},"33":{start:{line:96,column:21},end:{line:96,column:38}},"34":{start:{line:97,column:10},end:{line:107,column:13}},"35":{start:{line:98,column:17},end:{line:101,column:17}},"36":{start:{line:105,column:17},end:{line:105,column:36}},"37":{start:{line:117,column:25},end:{line:117,column:58}},"38":{start:{line:118,column:10},end:{line:118,column:48}},"39":{start:{line:124,column:6},end:{line:124,column:24}},"40":{start:{line:125,column:6},end:{line:125,column:65}},"41":{start:{line:131,column:6},end:{line:142,column:7}},"42":{start:{line:133,column:21},end:{line:133,column:38}},"43":{start:{line:135,column:10},end:{line:135,column:31}},"44":{start:{line:136,column:25},end:{line:136,column:56}},"45":{start:{line:137,column:10},end:{line:137,column:48}},"46":{start:{line:140,column:8},end:{line:140,column:26}},"47":{start:{line:141,column:8},end:{line:141,column:85}},"48":{start:{line:147,column:4},end:{line:170,column:5}},"49":{start:{line:149,column:21},end:{line:149,column:38}},"50":{start:{line:150,column:23},end:{line:152,column:11}},"51":{start:{line:155,column:26},end:{line:155,column:39}},"52":{start:{line:158,column:13},end:{line:158,column:49}},"53":{start:{line:159,column:13},end:{line:159,column:55}},"54":{start:{line:161,column:12},end:{line:161,column:91}},"55":{start:{line:168,column:6},end:{line:168,column:24}},"56":{start:{line:169,column:6},end:{line:169,column:73}},"57":{start:{line:174,column:4},end:{line:197,column:5}},"58":{start:{line:176,column:21},end:{line:176,column:38}},"59":{start:{line:181,column:10},end:{line:189,column:11}},"60":{start:{line:182,column:27},end:{line:182,column:56}},"61":{start:{line:183,column:12},end:{line:183,column:91}},"62":{start:{line:184,column:17},end:{line:189,column:11}},"63":{start:{line:185,column:27},end:{line:185,column:56}},"64":{start:{line:186,column:12},end:{line:186,column:91}},"65":{start:{line:188,column:12},end:{line:188,column:73}},"66":{start:{line:195,column:6},end:{line:195,column:24}},"67":{start:{line:196,column:6},end:{line:196,column:73}},"68":{start:{line:201,column:6},end:{line:217,column:7}},"69":{start:{line:203,column:25},end:{line:206,column:13}},"70":{start:{line:207,column:27},end:{line:207,column:57}},"71":{start:{line:208,column:12},end:{line:208,column:37}},"72":{start:{line:209,column:12},end:{line:209,column:48}},"73":{start:{line:215,column:8},end:{line:215,column:26}},"74":{start:{line:216,column:8},end:{line:216,column:75}},"75":{start:{line:222,column:4},end:{line:233,column:5}},"76":{start:{line:225,column:21},end:{line:225,column:38}},"77":{start:{line:226,column:25},end:{line:226,column:54}},"78":{start:{line:227,column:10},end:{line:227,column:48}},"79":{start:{line:231,column:6},end:{line:231,column:24}},"80":{start:{line:232,column:6},end:{line:232,column:73}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:15},end:{line:7,column:16}},loc:{start:{line:7,column:44},end:{line:35,column:5}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:37,column:22},end:{line:37,column:23}},loc:{start:{line:37,column:51},end:{line:48,column:5}},line:37},"2":{name:"(anonymous_2)",decl:{start:{line:50,column:16},end:{line:50,column:17}},loc:{start:{line:50,column:45},end:{line:89,column:3}},line:50},"3":{name:"(anonymous_3)",decl:{start:{line:91,column:16},end:{line:91,column:17}},loc:{start:{line:91,column:45},end:{line:127,column:3}},line:91},"4":{name:"(anonymous_4)",decl:{start:{line:130,column:21},end:{line:130,column:22}},loc:{start:{line:130,column:50},end:{line:143,column:5}},line:130},"5":{name:"(anonymous_5)",decl:{start:{line:146,column:25},end:{line:146,column:26}},loc:{start:{line:146,column:54},end:{line:171,column:3}},line:146},"6":{name:"(anonymous_6)",decl:{start:{line:173,column:18},end:{line:173,column:19}},loc:{start:{line:173,column:47},end:{line:198,column:3}},line:173},"7":{name:"(anonymous_7)",decl:{start:{line:200,column:17},end:{line:200,column:18}},loc:{start:{line:200,column:46},end:{line:218,column:5}},line:200},"8":{name:"(anonymous_8)",decl:{start:{line:221,column:18},end:{line:221,column:19}},loc:{start:{line:221,column:47},end:{line:234,column:3}},line:221}},branchMap:{"0":{loc:{start:{line:9,column:22},end:{line:9,column:48}},type:"binary-expr",locations:[{start:{line:9,column:22},end:{line:9,column:41}},{start:{line:9,column:45},end:{line:9,column:48}}],line:9},"1":{loc:{start:{line:10,column:27},end:{line:10,column:50}},type:"binary-expr",locations:[{start:{line:10,column:27},end:{line:10,column:45}},{start:{line:10,column:49},end:{line:10,column:50}}],line:10},"2":{loc:{start:{line:11,column:28},end:{line:11,column:54}},type:"binary-expr",locations:[{start:{line:11,column:28},end:{line:11,column:48}},{start:{line:11,column:52},end:{line:11,column:54}}],line:11},"3":{loc:{start:{line:12,column:23},end:{line:12,column:51}},type:"binary-expr",locations:[{start:{line:12,column:23},end:{line:12,column:43}},{start:{line:12,column:47},end:{line:12,column:51}}],line:12},"4":{loc:{start:{line:55,column:8},end:{line:65,column:11}},type:"if",locations:[{start:{line:55,column:8},end:{line:65,column:11}},{start:{line:55,column:8},end:{line:65,column:11}}],line:55},"5":{loc:{start:{line:97,column:10},end:{line:107,column:13}},type:"if",locations:[{start:{line:97,column:10},end:{line:107,column:13}},{start:{line:97,column:10},end:{line:107,column:13}}],line:97},"6":{loc:{start:{line:181,column:10},end:{line:189,column:11}},type:"if",locations:[{start:{line:181,column:10},end:{line:189,column:11}},{start:{line:181,column:10},end:{line:189,column:11}}],line:181},"7":{loc:{start:{line:184,column:17},end:{line:189,column:11}},type:"if",locations:[{start:{line:184,column:17},end:{line:189,column:11}},{start:{line:184,column:17},end:{line:189,column:11}}],line:184}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"9ff4c56aaec1e433f4a11a747d56c35943f06128"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1nnps9vlb2=function(){return actualCoverage;};}return actualCoverage;}cov_1nnps9vlb2();const Book=(cov_1nnps9vlb2().s[0]++,require('../models/books'));const erroHandler=(cov_1nnps9vlb2().s[1]++,require('../helpers/ErrorHandling'));const helper=(cov_1nnps9vlb2().s[2]++,require("../helpers/index"));cov_1nnps9vlb2().s[3]++;module.exports={getAllBooks:async(request,response)=>{cov_1nnps9vlb2().f[0]++;cov_1nnps9vlb2().s[4]++;try{const limit=(cov_1nnps9vlb2().s[5]++,(cov_1nnps9vlb2().b[0][0]++,request.query.limit)||(cov_1nnps9vlb2().b[0][1]++,100));const activePage=(cov_1nnps9vlb2().s[6]++,(cov_1nnps9vlb2().b[1][0]++,request.query.page)||(cov_1nnps9vlb2().b[1][1]++,1));const searchTitle=(cov_1nnps9vlb2().s[7]++,(cov_1nnps9vlb2().b[2][0]++,request.query.search)||(cov_1nnps9vlb2().b[2][1]++,''));const sortBy=(cov_1nnps9vlb2().s[8]++,(cov_1nnps9vlb2().b[3][0]++,request.query.sortBy)||(cov_1nnps9vlb2().b[3][1]++,'id'));const pagination=(cov_1nnps9vlb2().s[9]++,{activePage,limit,sortBy});const totalData=(cov_1nnps9vlb2().s[10]++,await Book.countData(searchTitle));// console.log(totalData)
const totalPages=(cov_1nnps9vlb2().s[11]++,Math.ceil(totalData/limit));// console.log(totalPages)
const pageDetail=(cov_1nnps9vlb2().s[12]++,{totalPages:totalPages,limit:limit,prev_page:activePage-1,next_page:activePage+1,page:activePage});const result=(cov_1nnps9vlb2().s[13]++,await Book.getAllBooks(searchTitle,pagination));cov_1nnps9vlb2().s[14]++;helper.response(response,200,result,pageDetail);}catch(error){cov_1nnps9vlb2().s[15]++;console.log(error);cov_1nnps9vlb2().s[16]++;helper.customErrorResponse(response,404,'cant see the book');}},getBookDataByID:async(request,response)=>{cov_1nnps9vlb2().f[1]++;cov_1nnps9vlb2().s[17]++;try{const id=(cov_1nnps9vlb2().s[18]++,request.params.id);const result=(cov_1nnps9vlb2().s[19]++,await Book.getBookDataByID(id));cov_1nnps9vlb2().s[20]++;helper.response(response,200,result);}catch(error){cov_1nnps9vlb2().s[21]++;console.log(error);cov_1nnps9vlb2().s[22]++;helper.customErrorResponse(response,404,'cant see the book details');}},addNewBook:async(request,response)=>{cov_1nnps9vlb2().f[2]++;cov_1nnps9vlb2().s[23]++;try{cov_1nnps9vlb2().s[24]++;// const role  = request.token.role;
// if (role == 2) {
if(request.file!=undefined){cov_1nnps9vlb2().b[4][0]++;cov_1nnps9vlb2().s[25]++;data={image:request.file.filename,...request.body};}else{cov_1nnps9vlb2().b[4][1]++;cov_1nnps9vlb2().s[26]++;data=request.body;}// const data = {
//   title: request.body.title,
//   description: request.body.description,
//   image: request.file.filename,
//   genre: request.body.genre,
//   author: request.body.author,
//   status: request.body.status,
//   created_at: new Date(),
//   updated_at: new Date()
// }
const result=(cov_1nnps9vlb2().s[27]++,await Book.addNewBook(data));cov_1nnps9vlb2().s[28]++;data.id=result.insertId;cov_1nnps9vlb2().s[29]++;helper.response(response,200,data);// } else {
//helper.customErrorResponse(response, 404, 'not user role!')
// }
}catch(error){cov_1nnps9vlb2().s[30]++;console.log(error);cov_1nnps9vlb2().s[31]++;helper.insertBooksErrorHandling(data,response);}},editBookData:async(request,response)=>{cov_1nnps9vlb2().f[3]++;cov_1nnps9vlb2().s[32]++;try{// const role  = request.token.role;
//  if (role == 2) {
const id=(cov_1nnps9vlb2().s[33]++,request.params.id);cov_1nnps9vlb2().s[34]++;if(request.file!=undefined){cov_1nnps9vlb2().b[5][0]++;cov_1nnps9vlb2().s[35]++;data={image:request.file.filename,...request.body};}else{cov_1nnps9vlb2().b[5][1]++;cov_1nnps9vlb2().s[36]++;data=request.body;}// const data = {
//    title: request.body.title,
//   description: request.body.description,
//   image: request.file.filename,
//   genre: request.body.genre,
//   author: request.body.author,
//   status: request.body.status,
//   updated_at: new Date()
// }
const result=(cov_1nnps9vlb2().s[37]++,await Book.editBookData(data,id));cov_1nnps9vlb2().s[38]++;helper.response(response,200,result);// } else {
//helper.customErrorResponse(response, 404, 'not user role!')
// }
}catch(error){cov_1nnps9vlb2().s[39]++;console.log(error);cov_1nnps9vlb2().s[40]++;helper.customErrorResponse(response,404,'cant edit book');}},getAllBorrowBook:async(request,response)=>{cov_1nnps9vlb2().f[4]++;cov_1nnps9vlb2().s[41]++;try{const id=(cov_1nnps9vlb2().s[42]++,request.params.id);cov_1nnps9vlb2().s[43]++;console.log("id",id);const result=(cov_1nnps9vlb2().s[44]++,await Book.getAllBorrowBook(id));cov_1nnps9vlb2().s[45]++;helper.response(response,200,result);}catch(error){cov_1nnps9vlb2().s[46]++;console.log(error);cov_1nnps9vlb2().s[47]++;helper.customErrorResponse(response,404,'cant see the borrow book details');}},borrowHistoryBookData:async(request,response)=>{cov_1nnps9vlb2().f[5]++;cov_1nnps9vlb2().s[48]++;try{const id=(cov_1nnps9vlb2().s[49]++,request.params.id);const data=(cov_1nnps9vlb2().s[50]++,{...request.body});// console.log(data.user_id)
const id_book=(cov_1nnps9vlb2().s[51]++,data.books_id);cov_1nnps9vlb2().s[52]++;await Book.borrowHistoryBookData(id);cov_1nnps9vlb2().s[53]++;await Book.borrowHistoryBookData1(id_book);cov_1nnps9vlb2().s[54]++;helper.response(response,200,{message:'The book was successfully borrowed'});// helper.response(response, 200, result)
}catch(error){cov_1nnps9vlb2().s[55]++;console.log(error);cov_1nnps9vlb2().s[56]++;helper.customErrorResponse(response,404,'Internal server error!');}},borrowBookData:async(request,response)=>{cov_1nnps9vlb2().f[6]++;cov_1nnps9vlb2().s[57]++;try{const id=(cov_1nnps9vlb2().s[58]++,request.params.id);// const data = {
//   status: request.body.status,
//   updated_at: new Date()
// }
cov_1nnps9vlb2().s[59]++;if(request.body.status=="borrow"){cov_1nnps9vlb2().b[6][0]++;const result=(cov_1nnps9vlb2().s[60]++,await Book.borrowBookData(id));cov_1nnps9vlb2().s[61]++;helper.response(response,200,{message:'The book was successfully borrowed'});}else{cov_1nnps9vlb2().b[6][1]++;cov_1nnps9vlb2().s[62]++;if(request.body.status=="return"){cov_1nnps9vlb2().b[7][0]++;const result=(cov_1nnps9vlb2().s[63]++,await Book.returnBookData(id));cov_1nnps9vlb2().s[64]++;helper.response(response,200,{message:'The book was returned successfully'});}else{cov_1nnps9vlb2().b[7][1]++;cov_1nnps9vlb2().s[65]++;helper.response(response,200,{message:'Status Not Found'});}}// helper.response(response, 200, result)
}catch(error){cov_1nnps9vlb2().s[66]++;console.log(error);cov_1nnps9vlb2().s[67]++;helper.customErrorResponse(response,404,'Internal server error!');}},addBorrowBook:async(request,response)=>{cov_1nnps9vlb2().f[7]++;cov_1nnps9vlb2().s[68]++;try{const data=(cov_1nnps9vlb2().s[69]++,{...request.body,created_at:new Date()});const result=(cov_1nnps9vlb2().s[70]++,await Book.addBorrowBook(data));cov_1nnps9vlb2().s[71]++;data.id=result.insertId;cov_1nnps9vlb2().s[72]++;helper.response(response,200,data);// helper.response(response, 200, result)
}catch(error){cov_1nnps9vlb2().s[73]++;console.log(error);cov_1nnps9vlb2().s[74]++;helper.customErrorResponse(response,404,'Internal server error!');}},deleteBookData:async(request,response)=>{cov_1nnps9vlb2().f[8]++;cov_1nnps9vlb2().s[75]++;try{const id=(cov_1nnps9vlb2().s[76]++,request.params.id);const result=(cov_1nnps9vlb2().s[77]++,await Book.deleteBookData(id));cov_1nnps9vlb2().s[78]++;helper.response(response,200,result);}catch(error){cov_1nnps9vlb2().s[79]++;console.log(error);cov_1nnps9vlb2().s[80]++;helper.customErrorResponse(response,404,'Internal server error!');}}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvb2tzLmpzIl0sIm5hbWVzIjpbIkJvb2siLCJyZXF1aXJlIiwiZXJyb0hhbmRsZXIiLCJoZWxwZXIiLCJtb2R1bGUiLCJleHBvcnRzIiwiZ2V0QWxsQm9va3MiLCJyZXF1ZXN0IiwicmVzcG9uc2UiLCJsaW1pdCIsInF1ZXJ5IiwiYWN0aXZlUGFnZSIsInBhZ2UiLCJzZWFyY2hUaXRsZSIsInNlYXJjaCIsInNvcnRCeSIsInBhZ2luYXRpb24iLCJ0b3RhbERhdGEiLCJjb3VudERhdGEiLCJ0b3RhbFBhZ2VzIiwiTWF0aCIsImNlaWwiLCJwYWdlRGV0YWlsIiwicHJldl9wYWdlIiwibmV4dF9wYWdlIiwicmVzdWx0IiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiY3VzdG9tRXJyb3JSZXNwb25zZSIsImdldEJvb2tEYXRhQnlJRCIsImlkIiwicGFyYW1zIiwiYWRkTmV3Qm9vayIsImZpbGUiLCJ1bmRlZmluZWQiLCJkYXRhIiwiaW1hZ2UiLCJmaWxlbmFtZSIsImJvZHkiLCJpbnNlcnRJZCIsImluc2VydEJvb2tzRXJyb3JIYW5kbGluZyIsImVkaXRCb29rRGF0YSIsImdldEFsbEJvcnJvd0Jvb2siLCJib3Jyb3dIaXN0b3J5Qm9va0RhdGEiLCJpZF9ib29rIiwiYm9va3NfaWQiLCJib3Jyb3dIaXN0b3J5Qm9va0RhdGExIiwibWVzc2FnZSIsImJvcnJvd0Jvb2tEYXRhIiwic3RhdHVzIiwicmV0dXJuQm9va0RhdGEiLCJhZGRCb3Jyb3dCb29rIiwiY3JlYXRlZF9hdCIsIkRhdGUiLCJkZWxldGVCb29rRGF0YSJdLCJtYXBwaW5ncyI6IjhyUkFlWTsyRkFmWixLQUFNQSxDQUFBQSxJQUFJLDBCQUFHQyxPQUFPLENBQUMsaUJBQUQsQ0FBVixDQUFWLENBRUEsS0FBTUMsQ0FBQUEsV0FBVywwQkFBR0QsT0FBTyxDQUFDLDBCQUFELENBQVYsQ0FBakIsQ0FDQSxLQUFNRSxDQUFBQSxNQUFNLDBCQUFHRixPQUFPLENBQUMsa0JBQUQsQ0FBVixDQUFaLEMsd0JB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LENBQUMwQixtQkFBUCxDQUEyQnJCLFFBQTNCLENBQXFDLEdBQXJDLENBQTBDLHdCQUExQyxFQUNELENBQ0YsQ0FwTlksQ0F1TmYrQyxjQUFjLENBQUUsTUFBT2hELE9BQVAsQ0FBZ0JDLFFBQWhCLEdBQTZCLGtEQUMzQyxHQUFJLENBR0UsS0FBTXVCLENBQUFBLEVBQUUsMkJBQUd4QixPQUFPLENBQUN5QixNQUFSLENBQWVELEVBQWxCLENBQVIsQ0FDQSxLQUFNTixDQUFBQSxNQUFNLDJCQUFHLEtBQU16QixDQUFBQSxJQUFJLENBQUN1RCxjQUFMLENBQW9CeEIsRUFBcEIsQ0FBVCxDQUFaLENBSkYseUJBS0U1QixNQUFNLENBQUNLLFFBQVAsQ0FBZ0JBLFFBQWhCLENBQTBCLEdBQTFCLENBQStCaUIsTUFBL0IsRUFHTCxDQUFDLE1BQU9DLEtBQVAsQ0FBYywwQkFDZEMsT0FBTyxDQUFDQyxHQUFSLENBQVlGLEtBQVosRUFEYyx5QkFFZHZCLE1BQU0sQ0FBQzBCLG1CQUFQLENBQTJCckIsUUFBM0IsQ0FBcUMsR0FBckMsQ0FBMEMsd0JBQTFDLEVBQ0QsQ0FDRixDQXBPYyxDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEJvb2sgPSByZXF1aXJlKCcuLi9tb2RlbHMvYm9va3MnKVxuXG5jb25zdCBlcnJvSGFuZGxlciA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvRXJyb3JIYW5kbGluZycpXG5jb25zdCBoZWxwZXIgPSByZXF1aXJlKFwiLi4vaGVscGVycy9pbmRleFwiKTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGdldEFsbEJvb2tzOiBhc3luYyAocmVxdWVzdCwgcmVzcG9uc2UpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGxpbWl0ID0gcmVxdWVzdC5xdWVyeS5saW1pdCB8fCAxMDBcbiAgICAgICAgY29uc3QgYWN0aXZlUGFnZSA9IHJlcXVlc3QucXVlcnkucGFnZSB8fCAxXG4gICAgICAgIGNvbnN0IHNlYXJjaFRpdGxlID0gcmVxdWVzdC5xdWVyeS5zZWFyY2ggfHwgJydcbiAgICAgICAgY29uc3Qgc29ydEJ5ID0gcmVxdWVzdC5xdWVyeS5zb3J0QnkgfHwgJ2lkJyBcblxuICAgICAgICBjb25zdCBwYWdpbmF0aW9uID0ge1xuICAgICAgICAgIGFjdGl2ZVBhZ2UsIGxpbWl0LCBzb3J0QnlcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRvdGFsRGF0YSA9IGF3YWl0IEJvb2suY291bnREYXRhKHNlYXJjaFRpdGxlKVxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0b3RhbERhdGEpXG4gICAgICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBNYXRoLmNlaWwodG90YWxEYXRhIC8gbGltaXQpXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRvdGFsUGFnZXMpXG4gICAgICAgIGNvbnN0IHBhZ2VEZXRhaWwgPSB7XG4gICAgICAgICAgdG90YWxQYWdlczogdG90YWxQYWdlcyxcbiAgICAgICAgICBsaW1pdDogbGltaXQsXG4gICAgICAgICAgcHJldl9wYWdlOiBhY3RpdmVQYWdlIC0gMSxcbiAgICAgICAgICBuZXh0X3BhZ2U6IGFjdGl2ZVBhZ2UgKyAxLFxuICAgICAgICAgIHBhZ2U6IGFjdGl2ZVBhZ2VcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBCb29rLmdldEFsbEJvb2tzKHNlYXJjaFRpdGxlLCBwYWdpbmF0aW9uKVxuICAgICAgICBoZWxwZXIucmVzcG9uc2UocmVzcG9uc2UsIDIwMCwgcmVzdWx0LCBwYWdlRGV0YWlsKVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXG4gICAgICAgIGhlbHBlci5jdXN0b21FcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDQsICdjYW50IHNlZSB0aGUgYm9vaycpXG4gICAgICB9XG4gICAgfSxcblxuICAgICBnZXRCb29rRGF0YUJ5SUQ6IGFzeW5jIChyZXF1ZXN0LCByZXNwb25zZSkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICBcbiAgICAgICAgICBjb25zdCBpZCA9IHJlcXVlc3QucGFyYW1zLmlkXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQm9vay5nZXRCb29rRGF0YUJ5SUQoaWQpXG4gICAgICAgICAgaGVscGVyLnJlc3BvbnNlKHJlc3BvbnNlLCAyMDAsIHJlc3VsdClcbiAgICAgIFxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXG4gICAgICAgIGhlbHBlci5jdXN0b21FcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDQsICdjYW50IHNlZSB0aGUgYm9vayBkZXRhaWxzJylcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgYWRkTmV3Qm9vazogYXN5bmMgKHJlcXVlc3QsIHJlc3BvbnNlKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAvLyBjb25zdCByb2xlICA9IHJlcXVlc3QudG9rZW4ucm9sZTtcbiAgICAgICAvLyBpZiAocm9sZSA9PSAyKSB7XG5cbiAgICAgICAgaWYocmVxdWVzdC5maWxlICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICBpbWFnZSA6IHJlcXVlc3QuZmlsZS5maWxlbmFtZSxcbiAgICAgICAgICAgICAgICAgIC4uLnJlcXVlc3QuYm9keVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1lbHNle1xuXG4gICAgICAgICAgICAgIGRhdGEgPSByZXF1ZXN0LmJvZHlcblxuICAgICAgICAgIH1cblxuICAgICAgICAvLyBjb25zdCBkYXRhID0ge1xuICAgICAgICAvLyAgIHRpdGxlOiByZXF1ZXN0LmJvZHkudGl0bGUsXG4gICAgICAgIC8vICAgZGVzY3JpcHRpb246IHJlcXVlc3QuYm9keS5kZXNjcmlwdGlvbixcbiAgICAgICAgLy8gICBpbWFnZTogcmVxdWVzdC5maWxlLmZpbGVuYW1lLFxuICAgICAgICAvLyAgIGdlbnJlOiByZXF1ZXN0LmJvZHkuZ2VucmUsXG4gICAgICAgIC8vICAgYXV0aG9yOiByZXF1ZXN0LmJvZHkuYXV0aG9yLFxuICAgICAgICAvLyAgIHN0YXR1czogcmVxdWVzdC5ib2R5LnN0YXR1cyxcbiAgICAgICAgLy8gICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAvLyAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKClcbiAgICAgICAgLy8gfVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBCb29rLmFkZE5ld0Jvb2soZGF0YSlcbiAgICAgICAgZGF0YS5pZCA9IHJlc3VsdC5pbnNlcnRJZFxuICAgICAgICBoZWxwZXIucmVzcG9uc2UocmVzcG9uc2UsIDIwMCwgZGF0YSlcblxuICAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAgICAgLy9oZWxwZXIuY3VzdG9tRXJyb3JSZXNwb25zZShyZXNwb25zZSwgNDA0LCAnbm90IHVzZXIgcm9sZSEnKVxuICAgICAgICAvLyB9XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpXG4gICAgICBoZWxwZXIuaW5zZXJ0Qm9va3NFcnJvckhhbmRsaW5nKGRhdGEsIHJlc3BvbnNlKVxuICAgIH1cbiAgfSxcblxuICBlZGl0Qm9va0RhdGE6IGFzeW5jIChyZXF1ZXN0LCByZXNwb25zZSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBjb25zdCByb2xlICA9IHJlcXVlc3QudG9rZW4ucm9sZTtcbiAgICAgIC8vICBpZiAocm9sZSA9PSAyKSB7XG5cbiAgICAgICAgICBjb25zdCBpZCA9IHJlcXVlc3QucGFyYW1zLmlkXG4gICAgICAgICAgaWYocmVxdWVzdC5maWxlICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGltYWdlIDogcmVxdWVzdC5maWxlLmZpbGVuYW1lLFxuICAgICAgICAgICAgICAgICAgICAuLi5yZXF1ZXN0LmJvZHlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1lbHNle1xuXG4gICAgICAgICAgICAgICAgIGRhdGEgPSByZXF1ZXN0LmJvZHlcblxuICAgICAgICAgICAgfVxuICAgICAgICAgIC8vIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgLy8gICAgdGl0bGU6IHJlcXVlc3QuYm9keS50aXRsZSxcbiAgICAgICAgICAvLyAgIGRlc2NyaXB0aW9uOiByZXF1ZXN0LmJvZHkuZGVzY3JpcHRpb24sXG4gICAgICAgICAgLy8gICBpbWFnZTogcmVxdWVzdC5maWxlLmZpbGVuYW1lLFxuICAgICAgICAgIC8vICAgZ2VucmU6IHJlcXVlc3QuYm9keS5nZW5yZSxcbiAgICAgICAgICAvLyAgIGF1dGhvcjogcmVxdWVzdC5ib2R5LmF1dGhvcixcbiAgICAgICAgICAvLyAgIHN0YXR1czogcmVxdWVzdC5ib2R5LnN0YXR1cyxcbiAgICAgICAgICAvLyAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKClcbiAgICAgICAgICAvLyB9XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQm9vay5lZGl0Qm9va0RhdGEoZGF0YSwgaWQpXG4gICAgICAgICAgaGVscGVyLnJlc3BvbnNlKHJlc3BvbnNlLCAyMDAsIHJlc3VsdClcblxuICAgICAgLy8gfSBlbHNlIHtcbiAgICAgICAgICAvL2hlbHBlci5jdXN0b21FcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDQsICdub3QgdXNlciByb2xlIScpXG4gICAgICAvLyB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxuICAgICAgaGVscGVyLmN1c3RvbUVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDQwNCwgJ2NhbnQgZWRpdCBib29rJylcbiAgICB9XG4gIH0sXG5cblxuICAgZ2V0QWxsQm9ycm93Qm9vazogYXN5bmMgKHJlcXVlc3QsIHJlc3BvbnNlKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgIFxuICAgICAgICAgIGNvbnN0IGlkID0gcmVxdWVzdC5wYXJhbXMuaWRcblxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiaWRcIiwgaWQpXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQm9vay5nZXRBbGxCb3Jyb3dCb29rKGlkKVxuICAgICAgICAgIGhlbHBlci5yZXNwb25zZShyZXNwb25zZSwgMjAwLCByZXN1bHQpXG4gICAgICBcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxuICAgICAgICBoZWxwZXIuY3VzdG9tRXJyb3JSZXNwb25zZShyZXNwb25zZSwgNDA0LCAnY2FudCBzZWUgdGhlIGJvcnJvdyBib29rIGRldGFpbHMnKVxuICAgICAgfVxuICAgIH0sXG5cblxuICBib3Jyb3dIaXN0b3J5Qm9va0RhdGE6IGFzeW5jIChyZXF1ZXN0LCByZXNwb25zZSkgPT4ge1xuICAgIHRyeSB7XG4gXG4gICAgICAgICAgY29uc3QgaWQgPSByZXF1ZXN0LnBhcmFtcy5pZFxuICAgICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAuLi5yZXF1ZXN0LmJvZHlcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhLnVzZXJfaWQpXG4gICAgICAgICAgY29uc3QgaWRfYm9vayA9IGRhdGEuYm9va3NfaWQ7XG5cblxuICAgICAgICAgICAgIGF3YWl0IEJvb2suYm9ycm93SGlzdG9yeUJvb2tEYXRhKGlkKVxuICAgICAgICAgICAgIGF3YWl0IEJvb2suYm9ycm93SGlzdG9yeUJvb2tEYXRhMShpZF9ib29rKVxuICAgICAgICAgXG4gICAgICAgICAgICBoZWxwZXIucmVzcG9uc2UocmVzcG9uc2UsIDIwMCwge21lc3NhZ2U6ICdUaGUgYm9vayB3YXMgc3VjY2Vzc2Z1bGx5IGJvcnJvd2VkJ30pICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICBcblxuICAgICAgICAgIC8vIGhlbHBlci5yZXNwb25zZShyZXNwb25zZSwgMjAwLCByZXN1bHQpXG5cbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcilcbiAgICAgIGhlbHBlci5jdXN0b21FcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDQsICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3IhJylcbiAgICB9XG4gIH0sXG5cbiAgYm9ycm93Qm9va0RhdGE6IGFzeW5jIChyZXF1ZXN0LCByZXNwb25zZSkgPT4ge1xuICAgIHRyeSB7XG4gXG4gICAgICAgICAgY29uc3QgaWQgPSByZXF1ZXN0LnBhcmFtcy5pZFxuICAgICAgICAgIC8vIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgLy8gICBzdGF0dXM6IHJlcXVlc3QuYm9keS5zdGF0dXMsXG4gICAgICAgICAgLy8gICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpXG4gICAgICAgICAgLy8gfVxuICAgICAgICAgIGlmKHJlcXVlc3QuYm9keS5zdGF0dXMgPT0gXCJib3Jyb3dcIil7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBCb29rLmJvcnJvd0Jvb2tEYXRhKGlkKVxuICAgICAgICAgICAgaGVscGVyLnJlc3BvbnNlKHJlc3BvbnNlLCAyMDAsIHttZXNzYWdlOiAnVGhlIGJvb2sgd2FzIHN1Y2Nlc3NmdWxseSBib3Jyb3dlZCd9KSAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgfSBlbHNlIGlmKHJlcXVlc3QuYm9keS5zdGF0dXMgPT0gXCJyZXR1cm5cIikge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQm9vay5yZXR1cm5Cb29rRGF0YShpZClcbiAgICAgICAgICAgIGhlbHBlci5yZXNwb25zZShyZXNwb25zZSwgMjAwLCB7bWVzc2FnZTogJ1RoZSBib29rIHdhcyByZXR1cm5lZCBzdWNjZXNzZnVsbHknfSkgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBoZWxwZXIucmVzcG9uc2UocmVzcG9uc2UsIDIwMCwge21lc3NhZ2U6ICdTdGF0dXMgTm90IEZvdW5kJ30pXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gaGVscGVyLnJlc3BvbnNlKHJlc3BvbnNlLCAyMDAsIHJlc3VsdClcblxuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxuICAgICAgaGVscGVyLmN1c3RvbUVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDQwNCwgJ0ludGVybmFsIHNlcnZlciBlcnJvciEnKVxuICAgIH1cbiAgfSxcblxuICBhZGRCb3Jyb3dCb29rOiBhc3luYyAocmVxdWVzdCwgcmVzcG9uc2UpID0+IHtcbiAgICAgIHRyeSB7XG4gICBcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAgIC4uLnJlcXVlc3QuYm9keSxcbiAgICAgICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQm9vay5hZGRCb3Jyb3dCb29rKGRhdGEpXG4gICAgICAgICAgICBkYXRhLmlkID0gcmVzdWx0Lmluc2VydElkXG4gICAgICAgICAgICBoZWxwZXIucmVzcG9uc2UocmVzcG9uc2UsIDIwMCwgZGF0YSlcblxuICAgICAgICAgICAgLy8gaGVscGVyLnJlc3BvbnNlKHJlc3BvbnNlLCAyMDAsIHJlc3VsdClcblxuICAgICAgICBcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxuICAgICAgICBoZWxwZXIuY3VzdG9tRXJyb3JSZXNwb25zZShyZXNwb25zZSwgNDA0LCAnSW50ZXJuYWwgc2VydmVyIGVycm9yIScpXG4gICAgICB9XG4gICAgfSxcblxuXG4gIGRlbGV0ZUJvb2tEYXRhOiBhc3luYyAocmVxdWVzdCwgcmVzcG9uc2UpID0+IHtcbiAgICB0cnkge1xuICAgICAgXG5cbiAgICAgICAgICBjb25zdCBpZCA9IHJlcXVlc3QucGFyYW1zLmlkXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQm9vay5kZWxldGVCb29rRGF0YShpZClcbiAgICAgICAgICBoZWxwZXIucmVzcG9uc2UocmVzcG9uc2UsIDIwMCwgcmVzdWx0KVxuXG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpXG4gICAgICBoZWxwZXIuY3VzdG9tRXJyb3JSZXNwb25zZShyZXNwb25zZSwgNDA0LCAnSW50ZXJuYWwgc2VydmVyIGVycm9yIScpXG4gICAgfVxuICB9XG5cbn0iXX0=